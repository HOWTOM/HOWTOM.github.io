<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css" integrity="sha384-SZXxX4whJ79/gErwcOYf+zWLeJdY/qpuqC4cAa9rOGUstPomtqpuNWT9wdPEn2fk" crossorigin="anonymous">
    <title>777</title>
    <style>
        i{
            font-size: 48px;
        }
        [box-id]{
            
            height: 80px;
            display: flex;
            justify-content: center;
            align-items: center;
            border: none;
            transition: 0.3s;
        }
        [box-id].active{
            border: 5px solid red;
            box-shadow: 0 0 20px red;
            transition: 0s;
        }

        #msg{
            font-size: 36px;
            text-align: center;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="row">
            <div box-id="1" class="col-1"></div>
            <div box-id="2" class="col-1"></div>
            <div box-id="3" class="col-1"></div>
            <div box-id="4" class="col-1"></div>
            <div box-id="5" class="col-1"></div>
            <div box-id="6" class="col-1"></div>
            <div box-id="7" class="col-1"></div>
            <div box-id="8" class="col-1"></div>
            <div box-id="9" class="col-1"></div>
            <div box-id="10" class="col-1"></div>
            <div box-id="11" class="col-1"></div>
            <div box-id="12" class="col-1"></div>
        </div>
        <div class="row">
            <div box-id="32" class="col-1"></div>
            <div class="col-10"></div>
            <div box-id="13" class="col-1"></div>
        </div>
        <div class="row">
            <div box-id="31" class="col-1"></div>
            <div class="col-10 m-auto">
                <p id="msg" class="m-0"></p>
            </div>
            <div box-id="14" class="col-1"></div>
        </div>
        <div class="row">
            <div box-id="30" class="col-1"></div>
            <div class="col-10"></div>
            <div box-id="15" class="col-1"></div>
        </div>
        <div class="row">
            <div box-id="29" class="col-1"></div>
            <div class="col-10"></div>
            <div box-id="16" class="col-1"></div>
        </div>
        <div class="row">
            <div box-id="28" class="col-1"></div>
            <div box-id="27" class="col-1"></div>
            <div box-id="26" class="col-1"></div>
            <div box-id="25" class="col-1"></div>
            <div box-id="24" class="col-1"></div>
            <div box-id="23" class="col-1"></div>
            <div box-id="22" class="col-1"></div>
            <div box-id="21" class="col-1"></div>
            <div box-id="20" class="col-1"></div>
            <div box-id="19" class="col-1"></div>
            <div box-id="18" class="col-1"></div>
            <div box-id="17" class="col-1"></div>
        </div>
        <div class="row">
            <button class="col-12">start</button>
        </div>

    </div>

    <script>
        let brickData = [
    {
        id:'1',
        icon:'fab fa-facebook-square',
        color:'blue',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'2',
        icon:'fab fa-instagram',
        color:'red',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'3',
        icon:'fab fa-line',
        color:'green',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'4',
        icon:'fab fa-facebook-square',
        color:'blue',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'5',
        icon:'fab fa-instagram',
        color:'red',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'6',
        icon:'fab fa-line',
        color:'green',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'7',
        icon:'fab fa-facebook-square',
        color:'blue',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'8',
        icon:'fab fa-instagram',
        color:'red',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'9',
        icon:'fab fa-line',
        color:'green',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'10',
        icon:'fab fa-facebook-square',
        color:'blue',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'11',
        icon:'fab fa-instagram',
        color:'red',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'12',
        icon:'fab fa-line',
        color:'green',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'13',
        icon:'fab fa-facebook-square',
        color:'blue',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'14',
        icon:'fab fa-instagram',
        color:'red',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'15',
        icon:'fab fa-line',
        color:'green',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'16',
        icon:'fab fa-facebook-square',
        color:'blue',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'17',
        icon:'fab fa-instagram',
        color:'red',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'18',
        icon:'fab fa-line',
        color:'green',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'19',
        icon:'fab fa-facebook-square',
        color:'blue',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'20',
        icon:'fab fa-instagram',
        color:'red',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'21',
        icon:'fab fa-line',
        color:'green',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'22',
        icon:'fab fa-facebook-square',
        color:'blue',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'23',
        icon:'fab fa-instagram',
        color:'red',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'24',
        icon:'fab fa-line',
        color:'green',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'25',
        icon:'fab fa-facebook-square',
        color:'blue',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'26',
        icon:'fab fa-instagram',
        color:'red',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'27',
        icon:'fab fa-line',
        color:'green',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'28',
        icon:'fab fa-facebook-square',
        color:'blue',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'29',
        icon:'fab fa-instagram',
        color:'red',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'30',
        icon:'fab fa-line',
        color:'green',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'31',
        icon:'fab fa-facebook-square',
        color:'blue',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
    {
        id:'32',
        icon:'fab fa-instagram',
        color:'red',
        target:function(){
            return this.icon.split('-')[1];
        }
    },
]

        let steps = 0; //剩下要走的步數
        let allSteps = 0; //全部的步數
        let currenIndex = 0; //目前走到哪一格
        let speed; //速率(越大越慢)

        //渲染畫面
        let bricks = document.querySelectorAll('[box-id]');
        bricks = Array.from(bricks).sort(
            (a,b) => {
                return a.getAttributeNode('box-id').value - b.getAttributeNode('box-id').value;
            })
            //console.log(bricks);
            bricks.forEach((x,index) =>{
                let id = index + 1;
                let data = brickData.find(x => x.id == id);
                let icon = document.createElement('i');
                icon.setAttribute('class',data.icon);
                icon.style.color = data.color;
                x.appendChild(icon);
            })

            //按下Start按鈕之後
            document.querySelector('button').addEventListener('click',function(){
                speed = 50;

                let random = Math.floor(Math.random()*brickData.length + 1);
                steps = random + (3 * brickData.length);
                allSteps = steps;
                turnAround();
            });
            function turnAround(){
                bricks[currenIndex].classList.remove('active');
                currenIndex++;
                if(currenIndex >= bricks.length) currenIndex = 0;

                bricks[currenIndex].classList.add('active');
                steps --;

                //一般
                // if(steps > 0){
                //     setTimeout(turnAround,speed);
                // }else{
                //     //跑完了
                //     let msgBox = document.getElementById('msg');
                //     let val = brickData[currenIndex].target();
                //     msgBox.innerText = `接下來 -> ${val}`;
                // }

                //變速
                if(steps > 0){
                    setTimeout(turnAround,speed);

                    //當剩下1/3時，開始減速
                    if(steps < Math.floor((allSteps / 3))) speed += 7;
                }else{
                    //跑完了
                    let msgBox = document.getElementById('msg');
                    let val = brickData[currenIndex].target();
                    msgBox.innerText = `接下來 -> ${val}`;
                }



            }


    </script>











    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4"
        crossorigin="anonymous"></script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.min.js" integrity="sha384-Atwg2Pkwv9vp0ygtn1JAojH0nYbwNJLPhwyoVbhoPwBhjQPR5VtM2+xf0Uwh9KtT" crossorigin="anonymous"></script>
    -->
</body>

</html>